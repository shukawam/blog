<!doctype html><html lang=en-us><head><title>// Shukawam's Daily Blog</title><link rel="shortcut icon" href=/favicon.ico><meta charset=utf-8><meta name=generator content="Hugo 0.74.2"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Shuhei Kawamura"><meta name=description content><link rel=stylesheet href=https://shukawam.github.io/blog/css/main.min.4a7ec8660f9a44b08c4da97c5f2e31b1192df1d4d0322e65c0dbbc6ecb1b863f.css><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="始めに FIDO2 による認証を Oracle の Identity Provider である IDCS(Oracle Identity Provider Service)を使ってさくっと作ってみます。IDCS は、Always Free でも触ることができるので是非試してみてください！
環境 構成図にも記載していますが、今回は
 Authenticator: Yubikey Client: IDCS 提供の画面 + α(認証成功後にリダイレクトされる画面等) Relying Party: Oracle Identity Cloud Service  という構成となっています。手元に認証器がない方は、Chrome の拡張の Virtual Authenticators Tab で代用可能です。
手順 IDCS のセットアップ Service Request を申請する OCI 契約時に自動的に含まれている IDCS では、FIDO Authenticator を使用したパスワードレス認証／MFA を使用することができないので、Service Request を申請し、機能の制限を解除してもらう必要があります。
詳しくはこちらをご参照ください。
Manage Passwordless Authentication
Group を作成する まずは、登録したユーザーが所属するグループを作成します。
管理コンソールから、グループ > 追加を押下し、グループを新しく作成します。
作成するグループは以下のよう。
現時点では、ユーザーを所属させる必要はないので、このまま終了を押し、グループの作成を完了させます。
自己登録プロファイルを作成する ユーザーのセルフサインアップを行うために、自己登録プロファイルを作成します。
管理コンソールから、設定 > 自己登録 > 追加を押下し、グループを新しく作成します。"><meta property="og:title" content><meta property="og:description" content="始めに FIDO2 による認証を Oracle の Identity Provider である IDCS(Oracle Identity Provider Service)を使ってさくっと作ってみます。IDCS は、Always Free でも触ることができるので是非試してみてください！
環境 構成図にも記載していますが、今回は
 Authenticator: Yubikey Client: IDCS 提供の画面 + α(認証成功後にリダイレクトされる画面等) Relying Party: Oracle Identity Cloud Service  という構成となっています。手元に認証器がない方は、Chrome の拡張の Virtual Authenticators Tab で代用可能です。
手順 IDCS のセットアップ Service Request を申請する OCI 契約時に自動的に含まれている IDCS では、FIDO Authenticator を使用したパスワードレス認証／MFA を使用することができないので、Service Request を申請し、機能の制限を解除してもらう必要があります。
詳しくはこちらをご参照ください。
Manage Passwordless Authentication
Group を作成する まずは、登録したユーザーが所属するグループを作成します。
管理コンソールから、グループ > 追加を押下し、グループを新しく作成します。
作成するグループは以下のよう。
現時点では、ユーザーを所属させる必要はないので、このまま終了を押し、グループの作成を完了させます。
自己登録プロファイルを作成する ユーザーのセルフサインアップを行うために、自己登録プロファイルを作成します。
管理コンソールから、設定 > 自己登録 > 追加を押下し、グループを新しく作成します。"><meta property="og:type" content="article"><meta property="og:url" content="https://shukawam.github.io/blog/qiita/get-started-fido2-with-idcs/get-started-fido2-with-idcs/"></head><body><header class=app-header><a href=https://shukawam.github.io/blog><img class=app-header-avatar src=/blog/avatar.jpg alt="Shuhei Kawamura"></a><h1>Shukawam's Daily Blog</h1><nav class=app-header-menu><a class=app-header-menu-item href=/blog/>Home</a>
-
<a class=app-header-menu-item href=/blog/tags/>Tags</a></nav><p>I'm Solutions Engineer at Oracle Japan. These articles are just my opinions.</p><div class=app-header-social><a href=https://github.com/shukawam target=_blank rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github"><title>Github</title><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a><a href=https://twitter.com/shukawam target=_blank rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-twitter"><title>Twitter</title><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a></div></header><main class=app-container><article class=post><header class=post-header><h1 class=post-title></h1><div class=post-meta><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Jan 1, 0001</div><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock"><title>clock</title><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>1 min read</div></div></header><div class=post-content><h1 id=始めに>始めに</h1><p>FIDO2 による認証を Oracle の Identity Provider である IDCS(Oracle Identity Provider Service)を使ってさくっと作ってみます。IDCS は、Always Free でも触ることができるので是非試してみてください！</p><h1 id=環境>環境</h1><p><img src=./images/image01.png alt=image01></p><p>構成図にも記載していますが、今回は</p><ul><li>Authenticator: Yubikey</li><li>Client: IDCS 提供の画面 + α(認証成功後にリダイレクトされる画面等)</li><li>Relying Party: Oracle Identity Cloud Service</li></ul><p>という構成となっています。手元に認証器がない方は、Chrome の拡張の <a href=https://github.com/google/virtual-authenticators-tab>Virtual Authenticators Tab</a> で代用可能です。</p><h1 id=手順>手順</h1><h2 id=idcs-のセットアップ>IDCS のセットアップ</h2><h3 id=service-request-を申請する>Service Request を申請する</h3><p>OCI 契約時に自動的に含まれている IDCS では、FIDO Authenticator を使用したパスワードレス認証／MFA を使用することができないので、Service Request を申請し、機能の制限を解除してもらう必要があります。<br>詳しくはこちらをご参照ください。</p><p><a href=https://docs.oracle.com/en/cloud/paas/identity-cloud/uaids/manage-passwordless-authentication.html#GUID-2BDA86CF-2733-4335-ACDB-DE13FCD300B4>Manage Passwordless Authentication</a></p><h3 id=group-を作成する>Group を作成する</h3><p>まずは、登録したユーザーが所属するグループを作成します。<br>管理コンソールから、<strong>グループ</strong> > <strong>追加</strong>を押下し、グループを新しく作成します。</p><p><img src=./images/image02.png alt=image02></p><p>作成するグループは以下のよう。</p><p><img src=./images/image03.png alt=image03></p><p>現時点では、ユーザーを所属させる必要はないので、このまま<strong>終了</strong>を押し、グループの作成を完了させます。</p><h3 id=自己登録プロファイルを作成する>自己登録プロファイルを作成する</h3><p>ユーザーのセルフサインアップを行うために、自己登録プロファイルを作成します。<br>管理コンソールから、<strong>設定</strong> > <strong>自己登録</strong> > <strong>追加</strong>を押下し、グループを新しく作成します。</p><p><img src=./images/image04.png alt=image04></p><p>以下のように入力し、プロファイルを作成します。</p><p><img src=./images/image05.png alt=image05></p><p>先ほど、作成したグループを割り当てる事で、このプロファイルに基づき登録されたユーザーが作成したグループ(FIDO)に所属するようになります。</p><h3 id=application-を作成する>Application を作成する</h3><p>ID 管理を行う単位であるアプリケーションを作成します。<br>管理コンソールから、<strong>アプリケーション</strong> > <strong>追加</strong>を押し、アプリケーションを作成します。</p><p><img src=./images/image06.png alt=image06></p><p><strong>機密アプリケーション</strong>を選択します。</p><p><img src=./images/image07.png alt=image07></p><p>その後、以下のように入力しアプリケーションを作成します。(記載のない内容については未入力で大丈夫です)</p><ul><li>詳細<ul><li>名前: FIDO</li></ul></li><li>クライアント<ul><li>許可される権限付与タイプ: クライアント資格証明、JWT アサーション、認可コード</li><li>HTTPS 以外の URL を許可にチェック</li><li>リダイレクト URL: <code>http://localhost/login-success.html</code></li></ul></li><li>リソース</li></ul><h3 id=idp-ポリシーを作成する>IdP ポリシーを作成する</h3><p>アプリケーションに設定する ID 管理のためのポリシー(ユーザーの認証方法 etc.)を設定します。</p><h3 id=サインオンポリシーを作成する>サインオンポリシーを作成する</h3><p>アプリケーションに設定するユーザーの認証時のポリシーを設定します。今回は、</p><ul><li>Username/Password を用いて認証したユーザーに対しては、2 番目の要素として FIDO 認証器による認証を強制する</li><li>FIDO の認証器を用いて認証したユーザーはそのまま認証可能(パスワードレス)</li></ul><p>というポリシーを設定したいと思います。</p><h2 id=認証成功後にリダイレクトされる画面を作成する>認証成功後にリダイレクトされる画面を作成する</h2><p>簡単な画面を作ったのでこちらをご活用ください。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>git clone https://github.com/shukawam/xxx.git
</code></pre></div><h1 id=終わりに>終わりに</h1><p>初めて触る方にとっては、想像したよりも簡単に生体認証を導入することができたのではないでしょうか。今回は、<strong>Identity Provider が FIDO2 の Relying Party を代わりに実装している</strong>形式で試してみましたが、学習がてら自分で実装してみたい方はこちらも参考にしてみてください。</p><p><a href=https://qiita.com/shukawam/items/4c1625bb6ae00e6b17f1>Helidon MP, WebAuthn4J で FIDO2(WebAuthn)</a></p></div><div class=post-footer></div></article></main></body></html>