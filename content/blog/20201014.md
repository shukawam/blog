+++
title = "Angularでバックエンドサーバにプロキシする"
description = ""
author = "Shuhei, Kawamura"
date = "2020-10-14"
tags = ["Angular", "Node.js"]
categories = ["tech"]
draft = "false"
[[images]]
  src = "img/2020/1007/main.png"
  alt = "main"
  stretch = "stretchH"
+++

# 始めに

ローカル環境でフロントエンド、バックエンドの開発を行うと以下の様な構成で開発することがある。

- フロントエンド：`http://localhost:4200`
- バックエンド：`http://localhost:8080`

オリジンが異なるパターンです。特に設定を加えずにバックエンドの API をコールしようとすると、CORS Policy で通信が拒否されます。

そのため、Angular を用いた開発では webpack dev server のプロキシサポートを使用して、特定の URL パスをバックエンドサーバに転送するという事が良く取られます。今回は、その手順（良く忘れるので自分への備忘録）です。

# 手順

1. `proxy.conf.json`を`src/`に以下の内容で新規に作成する。

```json
{
  "/api": {
    "target": "http://localhost:8080",
    "secure": false
  }
}
```

2. CLI 設定ファイル（`angular.json`）の設定を修正する。

```json
"architect": {
  "serve": {
    "builder": "@angular-devkit/build-angular:dev-server",
    "options": {
      "browserTarget": "your-application-name:build",
      "proxyConfig": "src/proxy.conf.json"
    },
```

3. `ng serve`で開発サーバを再起動する

# 参考

- [バックエンドサーバーへのプロキシ](https://angular.jp/guide/build#%E3%83%90%E3%83%83%E3%82%AF%E3%82%A8%E3%83%B3%E3%83%89%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%81%B8%E3%81%AE%E3%83%97%E3%83%AD%E3%82%AD%E3%82%B7)
