+++
title = "Oracle Object Storageで静的サイトをホスティングする"
description = ""
author = "Shuhei, Kawamura"
date = "2020-09-15"
tags = ["OCI" ,"Object Storage", "Angular", "Oracle"]
categories = ["tech"]
draft = "true"
[[images]]
  src = "img/2020/0916/oci.jpg"
  alt = "Mountain Scene"
  stretch = "stretchH"

+++

# 始めに

タイトルの通り、[Oracle Object Storage](https://docs.cloud.oracle.com/ja-jp/iaas/Content/Object/Concepts/objectstorageoverview.htm)で静的サイトをホスティングしてみたいと思います。[Amazon S3](https://aws.amazon.com/jp/s3/)にホスティングできるんだから、Oracle Object Storageでもできるんじゃ？と思ってやり始めました。



# バケットを作成する

GUIでポチポチ作ってもいいですが、CD（Continuous Delivery）やりたいと考えている方は、CLIベースでの操作に慣れておいた方がいいと思います。

```
$ oci os bucket create --compartment-id <compartment id> --namespace-name <namespace> --name website-hosting-sample --public-access-type ObjectRead
{
  "data": {
    "approximate-count": null,
    "approximate-size": null,
    "compartment-id": "*********************************************",
    "created-by": "*********************************************",       
    "defined-tags": {
      "Oracle-Tags": {
        "CreatedBy": "*********************************************",
        "CreatedOn": "2020-09-19T08:01:03.166Z"
      }
    },
    "etag": "4e97b07d-c8dd-4385-9b16-cf41188cbff1",
    "freeform-tags": {},
    "id": "*********************************************",   
    "is-read-only": false,
    "kms-key-id": null,
    "metadata": {},
    "name": "website-hosting-sample",
    "namespace": "*********************************************",
    "object-events-enabled": false,
    "object-lifecycle-policy-etag": null,
    "public-access-type": "ObjectRead",
    "replication-enabled": false,
    "storage-tier": "Standard",
    "time-created": "2020-09-19T08:01:03.193000+00:00",
    "versioning": "Disabled"
  },
  "etag": "4e97b07d-c8dd-4385-9b16-cf41188cbff1"
}
```

静的サイトとして公開するため、`public-access-type`を`ObjectRead`に変更しています。（デフォルトだと`NoPublicAccess`に設定される）

<!-- TODO: パス差し替え -->
![img01](https://shukawam.github.io/blog/img/2020/0916/img01.png)

# バケットに静的サイト資材を格納する

静的サイトを作成します。今回は、事前に作成済みの資産を配置したいと思います。（Angularで作成していますが、何でも良いです。）

```
$ git clone https://github.com/shukawam/oracle-object-storage-website-hosting-sample.git
$ cd oracle-object-storage-website-hosting-sample
$ npm install
$ ng build --prod
```
ビルドすると、トランスパイルされた資産が`dist/`に作成されるので`dist/oracle-object-storage-website-hosting-sample/*`をObject Storageにputします。


# 終わりに



# 参考

- [https://docs.cloud.oracle.com/ja-jp/iaas/Content/Object/Concepts/objectstorageoverview.htm](https://docs.cloud.oracle.com/ja-jp/iaas/Content/Object/Concepts/objectstorageoverview.htm)

- [https://docs.cloud.oracle.com/en-us/iaas/tools/oci-cli/2.12.10/oci_cli_docs/cmdref/os/bucket/create.html](https://docs.cloud.oracle.com/en-us/iaas/tools/oci-cli/2.12.10/oci_cli_docs/cmdref/os/bucket/create.html)